{#
SPDX-License-Identifier: Apache-2.0
SPDX-FileCopyrightText: 2025 The Linux Foundation
#}

<!DOCTYPE html>
<html lang="en" data-theme="{{ config.theme | default('default') }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Repository Reporting System">
    <meta name="theme" content="{{ config.theme | default('default') }}">
    <title>{{ project.name }} - Repository Analysis Report</title>

    {#- Theme CSS - Use relative path to themes directory -#}
    <link rel="stylesheet" href="../themes/{{ config.theme | default('default') }}/theme.css">

    {#- Fallback to default theme if custom theme fails to load -#}
    <noscript>
        <link rel="stylesheet" href="../themes/default/theme.css">
    </noscript>

    {#- Inline styles for print -#}
    <style>
        @media print {
            .no-print { display: none; }
            body { font-size: 10pt; }
        }
    </style>
</head>
<body>
    {#- Skip to content for accessibility -#}
    <a href="#main-content" class="skip-link">Skip to main content</a>

    {#- Page Header -#}
    <header class="page-header">
        <div class="container">
            <h1>{{ project.name }}</h1>
            <div class="metadata">
                <p class="generated-at">
                    <strong>Generated:</strong>
                    <time datetime="{{ project.generated_at }}">{{ project.generated_at_formatted }}</time>
                </p>
                <p class="schema-version">
                    <strong>Schema Version:</strong> {{ project.schema_version }}
                </p>
            </div>
        </div>
    </header>

    {#- Main Content -#}
    <main id="main-content" class="container">

        {#- Summary Section -#}
        {% include 'html/sections/summary.html.j2' %}

        {#- Repositories Section -#}
        {% include 'html/sections/repositories.html.j2' %}

        {#- Contributors Section -#}
        {% include 'html/sections/contributors.html.j2' %}

        {#- Organizations Section -#}
        {% include 'html/sections/organizations.html.j2' %}

        {#- Features Section -#}
        {% include 'html/sections/features.html.j2' %}

        {#- Workflows Section -#}
        {% include 'html/sections/workflows.html.j2' %}

        {#- Orphaned Jobs Section -#}
        {% include 'html/sections/orphaned_jobs.html.j2' %}

        {#- Time Windows Section -#}
        {% if time_windows is defined and time_windows is iterable and time_windows|length > 0 %}
        <section id="time-windows" class="report-section">
            <h2>Time Windows</h2>

            {% for window in time_windows %}
            <article class="time-window">
                <h3>{{ window.name }} <span class="window-duration">({{ window.days }} days)</span></h3>

                <p class="date-range">
                    <strong>Date Range:</strong>
                    <time datetime="{{ window.start_date }}">{{ window.start_date }}</time> to
                    <time datetime="{{ window.end_date }}">{{ window.end_date }}</time>
                </p>

                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Commits</td>
                            <td>{{ window.commits | format_number }}</td>
                        </tr>
                        <tr>
                            <td>Contributors</td>
                            <td>{{ window.contributors }}</td>
                        </tr>
                        <tr>
                            <td>Lines Added</td>
                            <td>{{ window.lines_added | format_number }}</td>
                        </tr>
                        <tr>
                            <td>Lines Removed</td>
                            <td>{{ window.lines_removed | format_number }}</td>
                        </tr>
                        <tr>
                            <td>Net Lines</td>
                            <td>{{ window.net_lines | format_number }}</td>
                        </tr>
                    </tbody>
                </table>
            </article>
            {% endfor %}
        </section>
        {% endif %}

    </main>

    {#- Page Footer -#}
    <footer class="page-footer">
        <div class="container">
            <p class="attribution">Report generated by <strong>Repository Reporting System</strong></p>
            <p class="timestamp">
                <time datetime="{{ project.generated_at }}">{{ project.generated_at_formatted }}</time>
            </p>
        </div>
    </footer>

</body>
</html>
